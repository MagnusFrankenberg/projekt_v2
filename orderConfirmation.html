<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="styles.css"> 
</head>
<body>

    

    <nav class="navbar navbar-expand-md">
        <div class="container">
          <a href="./index.html" class="navbar-brand">MyStore</a>
          <button class="navbar-toggler" data-bs-toggle="collapse"
          data-bs-target="#nav">
          <div class="navbar-toggler-icon"></div>
        </button>
          <div class="collapse navbar-collapse" id="nav">
            <ul class="navbar-nav">
                <li class="nav-item">
                  <a href="./index.html" class="nav-link active">Products</a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">Contact</a>
                </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="conf_container d-flex flex-column align-items-center">

<div class="conf_header text-center mt-4">
    <h1>Thank you for your order,</h1>
    <h2>Review your order information below</h2>
</div>
<div class="conf_orderItems m-1 p-2">

</div>
<div class="conf_orderTotal">
    <h4 id="orderTotal">Order Total:</h4>
  </div>
<div class="conf_deliveryAddress">
    <h4 class="recipient_header">Recipient:</h4>
    <h5 class="recipient_text" id="name"></h5>
    <h5 class="recipient_text" id="address"></h5>
    <h5 class="recipient_text" id="postalCode"></h5>
    <h5 class="recipient_text" id="city"></h5>
    <br>
    <div class="contactInfo border-2 border-top">
        <h5 id="phoneNumber"></h5>
        <h5 id="email"></h5>
    </div>
  </div>





    </div>
    <script>
        renderOrderItems();
        renderRecipient();


function renderRecipient(){
    document.getElementById('name').innerHTML = sessionStorage.getItem('name');
    document.getElementById('address').innerHTML = sessionStorage.getItem('address');
    document.getElementById('postalCode').innerHTML = sessionStorage.getItem('postalCode');
    document.getElementById('city').innerHTML = sessionStorage.getItem('city');
    document.getElementById('phoneNumber').innerHTML = sessionStorage.getItem('phoneNumber');
    document.getElementById('email').innerHTML = sessionStorage.getItem('email');

}


         //funktion för att visa shoppingcart 
function renderOrderItems(){
  let shoppingCart = JSON.parse(localStorage.getItem("shoppingCart")) || [];
  let orderTotal = 0;

  shoppingCart.forEach(e => {
    orderTotal += e.price;
  });

  orderTotal = orderTotal.toFixed(2);
  document.getElementById('orderTotal').innerHTML = `Order Total: €${orderTotal}`;


  const orderItems = document.querySelector('.conf_orderItems');


  if(shoppingCart.length){
    const uniqueItems = [...new Map(shoppingCart.map((item)=>[(item).title,(item)])).values()];

    uniqueItems.forEach((item)=>{
    let itemCount = shoppingCart.filter(e=>e.title==(item).title).length;

    let cartItem = document.createElement('div');
    cartItem.className = 'cartItem';
    cartItem.id = `cartItemId_${item.id}`;
    orderItems.appendChild(cartItem);

    let box_left = document.createElement('div');
    box_left.className = 'box_left';
    cartItem.appendChild(box_left);

    let cartImage = document.createElement('img');
    cartImage.className = 'cartImage';
    cartImage.src = `${(item).image}`;
    box_left.append(cartImage);

    let box_title = document.createElement('div');
    box_title.className = 'box_title';
    cartItem.appendChild(box_title);

    let iTitle = document.createElement('div');
    iTitle.className = 'iTitle';
    iTitle.innerHTML = `${(item).title}`;
    box_title.appendChild(iTitle);

    let box_price = document.createElement('div');
    box_price.className = 'box_price d-flex flex-row';
    cartItem.appendChild(box_price);

    let iQty = document.createElement('p');
    iQty.className = 'iQty';
    iQty.innerHTML = 'Qty:'
    box_price.appendChild(iQty);

    let iCount = document.createElement('div');
    iCount.className = 'icount';
    iCount.setAttribute('id',`iCountId_${(item).id}`)
    iCount.innerHTML = `${itemCount}`;
    box_price.appendChild(iCount);

    let iPrice = document.createElement('div');
    iPrice.className = 'iPrice';
    iPrice.innerHTML = `€${(item).price.toFixed(2)}`;
    box_price.appendChild(iPrice);

    let iPriceTot = document.createElement('div');
    iPriceTot.className = 'iPriceTot flex-fill';
    iPriceTot.innerHTML = `€${((item).price * itemCount).toFixed(2)}`;
    box_price.appendChild(iPriceTot);

    });
  }
}


    </script>
  
</body>
</html>